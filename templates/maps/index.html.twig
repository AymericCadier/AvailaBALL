<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MAPS</title>

    {% block stylesheets %}
        <link rel="stylesheet" href="{{ asset('styles/css/style.css') }}">
        <!-- <link rel="stylesheet" href="{{ asset('styles/css/maps.css') }}"> -->
        <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
              integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
              crossorigin=""/>
        <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
                integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
                crossorigin=""></script>

    {% endblock %}


</head>
<body>

{% block body %}
    <div class="d-flex flex-row">
        {% include 'base.html.twig' %}

        <div class="flex-grow-1">

            <div class="texte">
                <h1>MAPS</h1><br><br>
            </div>

            <div id="map">

                <iframe
                        width="600"
                        height="450"
                        frameborder="0" style="border:0"
                        loading="lazy"
                        referrerpolicy="no-referrer-when-downgrade"
                        src="https://www.google.com/maps/embed/v1/search?key=AIzaSyBaQqX1BORIFSqw2czUAGiMSxmocWTMapM&q=terrains+basket+in+Paris"
                        allowfullscreen>
                </iframe>
            </div>

            <select id="terrainSelect" onchange="updateButtons()">
                <option value="">Choisissez un terrain</option>
                <option value="terrain1">Terrain 1</option>
                <option value="terrain2">Terrain 2</option>
                <option value="terrain3">Terrain 3</option>
            </select>

            <div id="buttonsDiv" style="display: none;">
                <button onclick="notifyStatus(true)">J'y suis</button>
                <button onclick="notifyStatus(false)">Je n'y suis plus</button>
            </div>
        </div>


        <!-- Bootstrap Bundle with Popper -->
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/5.0.0-alpha1/js/bootstrap.bundle.min.js"></script>

        <script>
            // Initialisez la carte Leaflet
            var map = L.map('map').setView([48.8566, 2.3522], 13);
            map1 = L.map('map').setView([48.8576, 2.3542], 13);
            var marker = L.marker([48.8566, 2.3522]).addTo(map);

            // Ajoutez une couche de tuile OpenStreetMap à la carte
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
            }).addTo(map);

            // Ajoutez un marqueur à la carte
            L.marker([48.8566, 2.3522]).addTo(map)
                .bindPopup('Paris')
                .openPopup();
            var circle = L.circle([48.8566, 2.3522], {
                color: 'red',
                fillColor: '#f03',
                fillOpacity: 0.5,
                radius: 500
            }).addTo(map);
        </script>

        <script>
            function updateButtons() {
                var selectElement = document.getElementById("terrainSelect");
                var buttonsDiv = document.getElementById("buttonsDiv");

                // Afficher ou masquer les boutons en fonction du choix sélectionné
                if (selectElement.value !== "") {
                    buttonsDiv.style.display = "block";
                } else {
                    buttonsDiv.style.display = "none";
                }
            }

            function notifyStatus(present) {
                var selectElement = document.getElementById("terrainSelect");
                var selectedTerrain = selectElement.value;

                // Envoyer le choix et le statut à votre backend (par exemple, via une requête AJAX)

                // Exemple de requête AJAX fictive avec fetch()
                fetch('/update-status', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ terrain: selectedTerrain, present: present })
                })
                    .then(response => {
                        // Gérer la réponse du serveur
                        if (response.ok) {
                            console.log("Statut mis à jour avec succès !");
                        } else {
                            console.error("Erreur lors de la mise à jour du statut !");
                        }
                    })
                    .catch(error => {
                        console.error("Erreur lors de la communication avec le serveur :", error);
                    });
            }
        </script>

    </div>
{% endblock %}
</body>
</html>